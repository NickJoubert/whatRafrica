---
title: "R Notebook"
output: html_notebook
---
```{r}
data<-trade_zone_table

```

```{r}
Countries<-c("Algeria",
"Angola",
"Benin",
"Botswana",
"Burkina Faso",
'Burundi',
"Cabo Verde",
"Cameroon",
'Central African Republic',
"Chad",
"Comoros",
"Cote d'Ivoire",
'Democratic Republic of the Congo',
"Djibouti",
"Egypt",
'Equatorial Guinea',
"Eritrea",
"Ethiopia",
"Gabon",
"Gambia",
"Ghana",
"Guinea",
"Guinea-Bissau",
"Kenya",
"Lesotho",
"Liberia",
"Libya",
"Madagascar",
"Malawi",
"Mali",
"Mauritania",
"Mauritius",
"Morocco",
"Mozambique",
"Namibia",
"Niger",
"Nigeria",
'Republic of the Congo',
"Rwanda",
'Sao Tome and Principe',
'Senegal',
'Seychelles',
'Sierra Leone',
'Somalia',
'South Africa',
'South Sudan',
'Sudan',
'Swaziland',
'Tanzania',
'Togo',
'Tunisia',
'Uganda',
'Zambia',
'Zimbabwe'
)


```
```{r}
library(dplyr)
data[is.na(data)]<-0
data
```


```{r}


# Country_1 <-c(1,1,0,0)
# Country_2 <-c(1,0,1,0)
# Country_3 <-c(1,0,1,0)
# Country_4 <-c(0,1,0,1)
# Country_5 <-c(0,0,1,1)
# 
# Countries<-c("Country_1","Country_2","Country_3","Country_4","Country_5")
# Zone_1<-c(1,1,1,0,0)
# Zone_2<-c(1,0,0,1,0)
# Zone_3<-c(0,1,1,0,1)
# Zone_4<-c(0,0,0,1,1)


data<-as.matrix(data)
rownames(data) <- paste(Countries)

as_tbl_graph(graph.incidence(data))


```


```{r}
as_tbl_graph(graph.incidence(data)) %>% 
  ggraph()+
  geom_node_point(aes(shape = type, size = 20), show.legend = F)+
  geom_node_text(aes(label = name), colour = 'black', vjust = 4)+
  geom_edge_link()+
  theme_graph()
```

```{r}
data_project<- bipartite.projection(graph.incidence(data)) 
data_project

as_tbl_graph(data_project$proj1)
country_data<-as_tbl_graph(data_project$proj1)
```

```{r}
as_tbl_graph(data_project$proj1) %>% 
  ggraph()+
  geom_node_point(aes(size = 20), show.legend = F)+
  geom_node_text(aes(label = name), colour = 'black', vjust = 4)+
  geom_edge_link()+
  theme_graph()


```

```{r}
# random_graph <- sample_gnp(n = 100, 0.2)
graph_data<-as_tbl_graph(data)

# 
# GLI_rg <- as_tbl_graph(country_data) %>%
#   mutate(size = graph_order(),
#          edges = graph_size(),
#          density = edge_density(country_data),
#          average_distance = graph_mean_dist(),
#          trans = transitivity(country_data, type = "global")
#   ) %>%
#   as.data.frame()
# 
# GLI_rg

info<-country_data%>%
  activate(nodes)%>%
  mutate(betweenness = centrality_betweenness(normalized = TRUE),
         closeness = centrality_closeness(normalized = TRUE),
         transitivity = transitivity(country_data,type = "local"),
         degree = degree(country_data))%>%
  select(name,betweenness,closeness,transitivity,degree)%>%
  as.data.frame()
info




```
```{r}
library(ggplot2)


data.frame(info)%>%
  ggplot(aes(x=betweenness,y=closeness, label=name))+
  geom_point()+geom_text()+scale_x_log10()+geom_smooth(method="lm",size = 0.5)+ylab("Closeness Centrality")+xlab("betweenness")

```


```{r}
names(allinfo)
data.frame(allinfo)%>%
  ggplot(aes(x=African.rank,y=betweenness, label=name))+
  geom_point()+geom_text()+geom_smooth(method="lm",size = 0.5)+scale_x_log10()+scale_y_log10()+xlab("African.rank")+ylab("betweenness")

data.frame(allinfo)%>%
  ggplot(aes(x=African.rank,y=closeness, label=name))+
  geom_point()+geom_text()+geom_smooth(method="lm",size = 0.5)+scale_x_log10()+scale_y_log10()+xlab("African.rank")+ylab("closeness")

data.frame(allinfo)%>%
  ggplot(aes(x=GDP.perCapita,y=closeness, label=name))+
  geom_point()+geom_text()+geom_smooth(method="lm",size = 0.5)+scale_x_log10()+xlab('GDP.perCapita')+ylab("closeness")

data.frame(allinfo)%>%
  ggplot(aes(x=GDP.perCapita,y=betweenness, label=name))+
  geom_point()+geom_text()+geom_smooth(method="lm",size = 0.5)+scale_x_log10()+xlab('GDP.perCapita')+ylab("betweenness")

```




